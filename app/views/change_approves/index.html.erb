
<div class="card">
  <div class="card-body">


<table id="requestsDatatable" class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                
                <th>Project</th>
                <th>Requested by</th>
                <th>Department</th>
                <th>Telephone</th>
                <th>Description</th>
                <th>Required date</th>
                <th>Reason</th>
                <th>Sign off</th>
                <th>Approval</th>
                <td>Actions</td>
            </tr>
        </thead>
        <tbody>
          <% @change_requests.each do |change_request| %>
            <tr>
              
                
                <td><%= change_request.project %></td>
                <% if User.find_by_id(change_request.requested_by) == nil %>
                  <td><%= User.find_by_id(change_request.requested_by) %></td>
                <%else%>
                  <td><%= User.find_by_id(change_request.requested_by).email %></td>
                <%end%>
                <td><%= change_request.department %></td>
                <td><%= change_request.telephone %></td>
                <td><%= change_request.description %></td>
                <td><%= change_request.required_date %></td>
                <td><%= change_request.reason %></td>
                <td><%= change_request.sign_off %></td>
                <% if change_request.approval.length < 2  %>
                  <td>Pending</td>
                <%else%>
                  <td><%= change_request.approval %></td>
                <%end%>
                <td>
                  <div class="btn-group" role="group" aria-label="Basic example">
                    <% if ChangeApprove.find(change_request.id).status == nil%>
                    <%= link_to 'Approve', edit_change_approfe_path(change_request.id), class: "btn btn-success text-white" %><span class="pr-1"></span>
                    <%= link_to 'Decline', edit_change_approfe_path(change_request.id), class: "btn btn-danger text-white" %><span class="pr-1"></span>
                    <%elsif ChangeApprove.find(change_request.id).status == true %>
                      <span><% "Approved" %></span>
                    <%elsif ChangeApprove.find(change_request.id).status == false %>
                      <span><% "Declined" %></span>
                    <%end%>
                    <span class="pr-2"></span>
                    <%= link_to 'Change Implementation', edit_change_implementation_path(change_request.id), class: "btn btn-secondary text-white"%>

                  </div>
                  
                </td>
              
            </tr>
            <%end%>
        </tbody>
        <tfoot>
            <tr>
                
                <th>Project</th>
                <th>Requested by</th>
                <th>Department</th>
                <th>Telephone</th>
                <th>Description</th>
                <th>Required date</th>
                <th>Reason</th>
                <th>Sign off</th>
                <th>Approval</th>
                <th>Actions</th>
            </tr>
        </tfoot>

  </table>
  </div>
</div>
<script>
  $(document).ready(function() {
    //$('#requestsDatatable').DataTable();
  } );
  $('#requestsDatatable').DataTable();
  
</script>